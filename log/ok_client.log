➜  build git:(master) ✗ ./src/h2post

> GET https://127.0.0.1:8081/longPolling

22:38:56.080369 Info:   Trying 127.0.0.1:8081...
22:38:56.080443 Info: Connected to 127.0.0.1 (127.0.0.1) port 8081 (#0)
22:38:56.080845 Info: ALPN, offering h2
22:38:56.080856 Info: ALPN, offering http/1.1
22:38:56.084742 Info: successfully set certificate verify locations:
22:38:56.084754 Info:   CAfile: /etc/ssl/certs/ca-certificates.crt
  CApath: none
22:38:56.084900 Info: TLSv1.3 (OUT), TLS handshake, Client hello (1):
.
22:38:56.086250 Info: TLSv1.3 (IN), TLS handshake, Server hello (2):
22:38:56.086342 Info: TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
22:38:56.086399 Info: TLSv1.3 (IN), TLS handshake, Certificate (11):
22:38:56.086460 Info: TLSv1.3 (IN), TLS handshake, CERT verify (15):
22:38:56.086586 Info: TLSv1.3 (IN), TLS handshake, Finished (20):
22:38:56.086618 Info: TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
22:38:56.086649 Info: TLSv1.3 (OUT), TLS handshake, Finished (20):
22:38:56.086691 Info: SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384
22:38:56.086699 Info: ALPN, server accepted to use h2
22:38:56.086707 Info: Server certificate:
22:38:56.086716 Info:  subject: C=se
22:38:56.086727 Info:  start date: May 31 08:09:42 2020 GMT
22:38:56.086733 Info:  expire date: May 31 08:09:42 2021 GMT
22:38:56.086740 Info:  issuer: C=se
22:38:56.086747 Info:  SSL certificate verify result: self signed certificate (18), continuing anyway.
22:38:56.086777 Info: Using HTTP2, server supports multi-use
22:38:56.086783 Info: Connection state changed (HTTP/2 confirmed)
22:38:56.086791 Info: Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0
22:38:56.086798 Info: nghttp2_session_mem_recv() returns 0
22:38:56.086873 Info: http2_send len=62
22:38:56.086882 Info: h2 header: :method:GET
22:38:56.086887 Info: h2 header: :path:/longPolling
22:38:56.086892 Info: h2 header: :scheme:https
22:38:56.086897 Info: h2 header: :authority:127.0.0.1:8081
22:38:56.086902 Info: h2 header: accept:*/*
22:38:56.086909 Info: Using Stream ID: 1 (easy handle 0x55e9c15de8f8)
=> Send header, 62 bytes (0x3e)
0000: GET /longPolling HTTP/2
0019: Host: 127.0.0.1:8081
002f: accept: */*
003c:
.
22:38:56.091200 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554432/65535
22:38:56.091245 Info: TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
22:38:56.091284 Info: TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
22:38:56.091300 Info: old SSL session ID is stale, removing
22:38:56.091323 Info: nread=9
22:38:56.091331 Info: Got SETTINGS
22:38:56.091344 Info: MAX_CONCURRENT_STREAMS == -1
22:38:56.091349 Info: ENABLE_PUSH == TRUE
22:38:56.091355 Info: Connection state changed (MAX_CONCURRENT_STREAMS == 4294967295)!
22:38:56.091362 Info: nghttp2_session_mem_recv() returns 9
22:38:56.091367 Info: All data in connection buffer processed
22:38:56.091398 Info: http2_recv returns AGAIN for stream 1
22:38:56.091412 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554432/65535
22:38:56.091430 Info: nread=9
22:38:56.091436 Info: Got SETTINGS
22:38:56.091441 Info: MAX_CONCURRENT_STREAMS == -1
22:38:56.091446 Info: ENABLE_PUSH == TRUE
22:38:56.091452 Info: nghttp2_session_mem_recv() returns 9
22:38:56.091457 Info: All data in connection buffer processed
22:38:56.091463 Info: http2_recv returns AGAIN for stream 1
.
22:38:56.095742 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554432/33554432
22:38:56.095768 Info: nread=105
22:38:56.095777 Info: on_begin_headers() was called
22:38:56.095784 Info: h2 status: HTTP/2 200 (easy 0x55e9c15de8f8)
22:38:56.095792 Info: h2 header: content-type: multipart/related; boundary=example-boundary-1234
22:38:56.095798 Info: h2 header: date: Mon, 30 Aug 2021 13:38:56 GMT
22:38:56.095803 Info: on_frame_recv() header 1 stream 1
22:38:56.095809 Info: Store 117 bytes headers from stream 1 at 0x55e9c15e00f8
22:38:56.095815 Info: 24 data received for stream 1 (16243 left in buffer 0x55e9c15e00f8, total 141)
22:38:56.095820 Info: on_frame_recv() header 0 stream 1
22:38:56.095825 Info: nghttp2_session_mem_recv() returns 105
22:38:56.095830 Info: All data in connection buffer processed
22:38:56.095835 Info: http2_recv: returns 141 for stream 1
<= Recv header, 13 bytes (0xd)
0000: HTTP/2 200
<= Recv header, 65 bytes (0x41)
0000: content-type: multipart/related; boundary=example-boundary-1234
<= Recv header, 37 bytes (0x25)
0000: date: Mon, 30 Aug 2021 13:38:56 GMT
<= Recv header, 2 bytes (0x2)
0000:
<= Recv data, 24 bytes (0x18)
0000: --example-boundary-1234.
22:38:56.096102 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554408/33554408
.-example-boundary-1234
.
.
.
.
.
.
.

uploadsize = 1274


> PATH https://127.0.0.1:8081/post

22:39:03.288640 Info: Found bundle for host 127.0.0.1: 0x55e9c15d57e8 [can multiplex]
22:39:03.288685 Info: Multiplexed connection found!
22:39:03.288705 Info: Re-using existing connection! (#0) with host 127.0.0.1
22:39:03.288754 Info: http2_send len=135
22:39:03.288762 Info: h2 header: :method:POST
22:39:03.288767 Info: h2 header: :path:/post
22:39:03.288771 Info: h2 header: :scheme:https
22:39:03.288776 Info: h2 header: :authority:127.0.0.1:8081
22:39:03.288780 Info: h2 header: accept:*/*
22:39:03.288798 Info: h2 header: content-type:multipart/form-data; boundary=nugusdk.boundary.24dfa2ab02147913
22:39:03.288830 Info: Using Stream ID: 3 (easy handle 0x55e9c16b4088)
=> Send header, 135 bytes (0x87)
0000: POST /post HTTP/2
0013: Host: 127.0.0.1:8081
0029: accept: */*
0036: content-type: multipart/form-data; boundary=nugusdk.boundary.24d
0076: fa2ab02147913
0085:

read 100 bytes from file

22:39:03.289057 Info: http2_send len=100
22:39:03.289063 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.289255 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: --nugusdk.boundary.14977be1c88d3131.Content-Disposition: form-da
0040: ta; name="event".Content-Type: appli
.

read 100 bytes from file

22:39:03.289399 Info: http2_send len=100
22:39:03.289406 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.289466 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: cation/json..{ "context": {"client":{"os":"Linux","playStack":[]
0040: ,"wakeupWord":"Aria"},"supportedInte
.

read 100 bytes from file

22:39:03.289606 Info: http2_send len=100
22:39:03.289613 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.289637 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: rfaces":{"ASR":{"engine":"skt","initiator":"TAP","state":"IDLE",
0040: "version":"1.6"},"AudioPlayer":{"lyr
.

read 100 bytes from file

22:39:03.289763 Info: http2_send len=100
22:39:03.289769 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.289793 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: icsVisible":false,"offsetInMilliseconds":0,"playerActivity":"IDL
0040: E","version":"1.6"},"Chips":{"versio
.

read 100 bytes from file

22:39:03.289945 Info: http2_send len=100
22:39:03.289952 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.289977 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: n":"1.2"},"Display":{"version":"1.8"},"Extension":{"data":{},"ve
0040: rsion":"1.1"},"Mic":{"micStatus":"ON
.

read 100 bytes from file

22:39:03.290114 Info: http2_send len=100
22:39:03.290121 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.290145 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: ","version":"1.0"},"Nudge":{"version":"1.0"},"Routine":{"routine
0040: Activity":"IDLE","version":"1.2"},"S
.

read 100 bytes from file

22:39:03.290274 Info: http2_send len=100
22:39:03.290281 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.290305 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: ession":{"version":"1.0"},"Sound":{"version":"1.0"},"Speaker":{"
0040: version":"1.2","volumes":[{"defaultV
.

read 100 bytes from file

22:39:03.290448 Info: http2_send len=100
22:39:03.290454 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.290476 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: olumeLevel":50,"defaultVolumeStep":10,"maxVolume":100,"minVolume
0040: ":0,"muted":false,"name":"NUGU","vol
.
22:39:03.290600 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554408/33554408
22:39:03.290621 Info: nread=34
22:39:03.290628 Info: on_begin_headers() was called
22:39:03.290638 Info: h2 status: HTTP/2 200 (easy 0x55e9c16b4088)
22:39:03.290648 Info: h2 header: date: Mon, 30 Aug 2021 13:39:03 GMT
22:39:03.290654 Info: on_frame_recv() header 1 stream 3
22:39:03.290661 Info: Store 52 bytes headers from stream 3 at 0x55e9c16bb448
22:39:03.290668 Info: nghttp2_session_mem_recv() returns 34
22:39:03.290673 Info: All data in connection buffer processed
22:39:03.290679 Info: http2_recv returns AGAIN for stream 1
22:39:03.290691 Info: http2_recv: easy 0x55e9c16b4088 (stream 3) win 33554408/33554432
22:39:03.290698 Info: http2_recv: DRAIN 52 bytes stream 3!! (0x55e9c16bb448 => 0x55e9c16bb448)
22:39:03.290704 Info: http2_recv: returns 52 for stream 3
<= Recv header, 13 bytes (0xd)
0000: HTTP/2 200
<= Recv header, 37 bytes (0x25)
0000: date: Mon, 30 Aug 2021 13:39:03 GMT
<= Recv header, 2 bytes (0x2)
0000:
22:39:03.290781 Info: http2_recv: easy 0x55e9c16b4088 (stream 3) win 33554408/33554432
.

read 100 bytes from file

22:39:03.290809 Info: http2_send len=100
22:39:03.290816 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.290839 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: ume":50}]},"System":{"version":"1.3"},"TTS":{"engine":"skt","tts
0040: Activity":"IDLE","version":"1.3"},"T
.

read 100 bytes from file

22:39:03.290971 Info: http2_send len=100
22:39:03.290977 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.290999 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: ext":{"version":"1.5"},"Utility":{"version":"1.0"}}}, "event": {
0040:  "header": { "dialogRequestId": "137
.

read 100 bytes from file

22:39:03.291132 Info: http2_send len=100
22:39:03.291139 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.291161 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: b05ae6901b4aac5a794dee53cf03b", "messageId": "137b05ae6901b4aac5
0040: a794de32e6667c", "name": "Recognize"
.

read 100 bytes from file

22:39:03.291286 Info: http2_send len=100
22:39:03.291292 Info: data_source_read_callback: returns 100 bytes stream 3
22:39:03.291313 Info: http2_send returns 100 for stream 3
=> Send data, 100 bytes (0x64)
0000: , "namespace": "ASR", "version": "1.6" }, "payload": {"codec":"S
0040: PEEX","encoding":"COMPLETE","endpoin
.

read 74 bytes from file

22:39:03.291464 Info: http2_send len=74
22:39:03.291471 Info: data_source_read_callback: returns 74 bytes stream 3
22:39:03.291493 Info: http2_send returns 74 for stream 3
=> Send data, 74 bytes (0x4a)
0000: ting":"CLIENT","language":"KOR"} } }.--nugusdk.boundary.14977be1
0040: c88d3131..
.

read 0 bytes from file

22:39:03.291601 Info: h2_process_pending_input: All data in connection buffer processed
22:39:03.291607 Info: data_source_read_callback: returns 0 bytes stream 3
.
.
.
22:39:06.102004 Info: http2_recv: easy 0x55e9c15de8f8 (stream 1) win 33554408/33554408
22:39:06.102161 Info: nread=21
22:39:06.102202 Info: 12 data received for stream 1 (16372 left in buffer 0x55e9c15e00f8, total 12)
22:39:06.102229 Info: on_frame_recv() header 0 stream 1
22:39:06.102267 Info: on_stream_close(), Success (err 0), stream 1
22:39:06.102305 Info: Removed stream 1 hash!
22:39:06.102311 Info: nghttp2_session_mem_recv() returns 21
22:39:06.102316 Info: All data in connection buffer processed
22:39:06.102321 Info: http2_recv: returns 12 for stream 0
22:39:06.102325 Info: Data returned for PAUSED stream 0
<= Recv data, 12 bytes (0xc)
0000: GET-FINISHED
22:39:06.102380 Info: http2_recv: easy 0x55e9c15de8f8 (stream 0) win 33554396/4294967295
22:39:06.102389 Info: h2_process_pending_input: All data in connection buffer processed
22:39:06.102395 Info: http2_recv returns 0, http2_handle_stream_close
GET-FINISHED.
.
.
22:39:08.291958 Info: http2_recv: easy 0x55e9c16b4088 (stream 3) win 33554396/33554432
22:39:08.292006 Info: nread=22
22:39:08.292017 Info: 13 data received for stream 3 (16371 left in buffer 0x55e9c16bb448, total 13)
22:39:08.292022 Info: on_frame_recv() header 0 stream 3
22:39:08.292028 Info: on_stream_close(), Success (err 0), stream 3
22:39:08.292036 Info: Removed stream 3 hash!
22:39:08.292042 Info: nghttp2_session_mem_recv() returns 22
22:39:08.292047 Info: All data in connection buffer processed
22:39:08.292052 Info: http2_recv: returns 13 for stream 0
22:39:08.292057 Info: Data returned for PAUSED stream 0
<= Recv data, 13 bytes (0xd)
0000: POST-FINISHED
22:39:08.292088 Info: http2_recv: easy 0x55e9c16b4088 (stream 0) win 33554383/4294967295
22:39:08.292097 Info: h2_process_pending_input: All data in connection buffer processed
22:39:08.292102 Info: http2_recv returns 0, http2_handle_stream_close
22:39:08.292121 Info: Connection #0 to host 127.0.0.1 left intact
POST-FINISHED%
